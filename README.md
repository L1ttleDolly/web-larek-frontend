# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных используемых в приложении

**Интерфейс данных пользователя**

```
export interface IUserData {
	payment: TPaymentMethod;
	email: string;
	phone: string;
	address: string;
}
```

**Интерфейс описания товара**

```
export interface IProduct { 
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
}
```

**Интерфейс каталога всех товаров**

```
export interface IProductsData { //каталог всех карточек
	products: IProduct[];
	preview: string | null;
}
```

**Тип способа оплаты, используемый в Интерфейсе Описания Товара**

```
type TPaymentMethod = 'online' | 'on_delivery';
```

**Тип данных используемых в форме оплаты**

```
export type TPayment = Pick<IUserData, 'payment' | 'address'>;
```

**Тип данных используемых в форме контактов пользователя**

```
export type TContactInfo = Pick<IUserData, 'email' | 'phone'>;
```

**Тип данных используемых в корзине для списка товаров**

```
export type  TBasketItem = Pick<IProduct, 'id' | 'title' | 'price'>;
```

**Тип данных используемых в попапе картинки**

```
export  type TProductCard = Pick<IProduct, 'image' | 'title' | 'category' | 'price'>
```

## Архитектура приложения

Код приложения сделан в парадигме MVP:
- Слой данных, отвечает за хранение и изменение данными.
- Слой представления, отвечает за отображение данных на странице.
- Презентер отвечает за связь между слоем данных и слоем представления.

### Базовый код

#### Класс Api

Содержит в себе базовую логику отправки запросов. 
В конструктор передается базовый адрес страницы `baseUrl: string,` 
и опциональный объект с заголовками запросов `options: RequestInit = {}`

- `get` - Выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер.
- `post` - Принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

### Класс EventEmitter

Этот интерфейс описывает методы, которые должен реализовывать любой класс, работающий с событиями:`IEvents`:
- `on` - Подписывает обработчик на событие. Если для события ещё нет подписчиков, создается новый набор для этого события.
- `emit` - Инициирует событие и вызывает все подписанные на него обработчики.
- `trigger` - Метод для создания триггер-функции, которая будет генерировать событие при вызове.

### Слой данных

#### Класс IUserBasket
Класс отвечает за работу данных связанных с корзиной
Конструктор класса принимает инстант брокера событий

Так же класс предоставляет набор методов для взаимодействия с этими данными.

- addItem(item: IProduct): void; - Добавляет один товар в корзину.
- deleteItem(cardId: string): void; - Удаляет один товар из корзины.
- clearBasket(): void; - Удаляет все товары из корзины.
- getItemsList(): TBasketItem[]; - Получение списка всех товаров находящихся в корзине.
- checkedAllItems(): number; - Получение общей суммых всех товаров находящихся в корзине.
- events: IEvents - экземпляр класса `EventEmitter` для инициации событий при изменении данных.
- а так-же сеттеры и геттеры для сохранения и получения данных из полей класса


#### Класс IProductsCatalog
Класс отвечает за работу данных связанных с отображаемым массивом карточек на странице
Конструктор класса принимает инстант брокера событий

- fillCatalog(item: IProduct): void; - Заполняет каталог карточками
- getCatalog(): IProductsData; - Получить весь каталог карточек
- events: IEvents - экземпляр класса `EventEmitter` для инициации событий при изменении данных.

### Классы представления
Все классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных.


#### Базовый Класс Component

### Класс Modal
Реализует модальное окно. Так же предоставляет методы `open` и `close` для управления отображением модального окна. 
Имеет сеттер, для установки нового контента в модальное окно
- constructor(selector: string, events: IEvents) Конструктор принимает селектор, по которому в разметке страницы будет идентифицировано модальное окно и экземпляр класса `EventEmitter` для возможности инициации событий.

Поля класса
- _closeButton: HTMLButtonElement - кнопка закрытия модального окна
- _content: HTMLElement - содержимое модального окна

### Класс Form
Класс, представляющий общую форму с функциональностью валидации и обработки ошибок.
Отвечает за управление состоянием формы, валидацию и вывод ошибок.\
Также предоставляет методы для работы с состоянием формы:\
`valid` для валидации и `errors` для вывода ошибок.

#### Класс FormContacts
Дочерний класс `Form`, для формы, содержащей информацию о контактных данных пользователя.\
Включает в себя поля для email и телефона пользователя.\
Обеспечивает валидацию и обработку ошибок для контактных данных.

#### Класс FormOrder
Дочерний класс `Form`, содержащий информацию о заказе пользователя.\
Включает в себя поля для адреса и способа оплаты пользователя.\
Обеспечивает валидацию и обработку ошибок для данных заказа.

### Класс  Gallery
Класс для работы с галереей.\
Отвечает за отображение элементов галереи.
Имеет метод `set` для добавляем элементов галереи в контейнер.

### Класс Header
Класс для отображения корзины с количеством товаров.\
Наследуется от компонента и отображает информацию о количестве товаров в корзине.\
Имеет метод `set` для установки значения счётчика в корзине.

### Класс Card 
Базовый класс карточки товара.
Имеет метод `displayCardInfo(): void ` для отображения информации о карточке товара.

#### Класс CardCatalog
Дочерний класс `Card`, для карточки товара в каталоге, имеет метод `set`
для установки цены товара.

#### Класс CardBasket
Дочерний класс `Card`, для карточки товара в корзине, имеет метод `deleteItem`
для удаления товара из корзины.

#### Класс CardModal
Дочерний класс `Card`, для карточки товара в модальном окне, имеет метод `buyCard`
для покупки товара.

### Слой коммуникации

## Взаимодействие компонентов
Код, описывающий взаимодействие представления и данных между собой находится в файле `index.ts`, выполняющем роль презентера.\
Взаимодействие осуществляется за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в `index.ts`\
В `index.ts` сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.
